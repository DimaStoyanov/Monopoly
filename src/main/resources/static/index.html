<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Yandex map</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
    <script src="https://yandex.st/jquery/2.2.3/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        function sendMessage() {
            var messageField = document.getElementById("message");
            var message = messageField.value;
            var $textarea = document.getElementById("messages");
            $textarea.value = $textarea.value + message + "\n";
            messageField.value = '';
        }
    </script>

    <style type="text/css">
        html, body {
            width: 100%;
            height: 95%;
            margin: 0;
            padding: 0;
            font-family: Arial, serif;
            font-size: 14px;
        }

        #map {
            width: 100%;
            height: 60%;
        }

        #menu {
            position: absolute;
            width: 12em;
            background: white;
            border: 1px solid #ccc;
            border-radius: 12px;
            padding-bottom: 10px;
            z-index: 2
        }

        #menu ul {
            list-style-type: none;
            padding: 20px;
            margin: 0;
        }

        input {
            width: 10em;
        }

        .header {
            padding: 5px;
        }
    </style>

</head>
<body>

<div id="map"></div>
<div align="center">
    <p> Game state. Some hint</p>
    <button> doSmth</button>
</div>
<br>
<div id="chatbox" align="center" style="height:38%; width:100%; background-color: azure">
    <br>
    <textarea id="messages" rows="13" cols="150" readonly="readonly"></textarea>

    <form id="msg" name="message">
        <input name="usermsg" type="text" id="message" style="width: 1080px">
        <input type="button" name="submitmsg" value="Send" onclick="sendMessage();">
    </form>
</div>

</body>

<script type="text/javascript">


    ymaps.ready(init);
    var myMap, myRectangle, myRectangle2, myRectangle3, myRectangle4, myRectangle5;

    function init() {
        myMap = new ymaps.Map('map', {
            center: [55.674, 37.601],
            zoom: 11
        }, {
            searchControlProvider: 'yandex#search'
        });

        myRectangle = new ymaps.Rectangle([
            // Задаем координаты диагональных углов прямоугольника.
            [55.70, 37.55],
            [55.72, 37.53]
        ], null, {
            // Опции.
            // Цвет и прозрачность заливки.
            fillColor: '#7df9ff33',
            // Дополнительная прозрачность заливки..
            // Итоговая прозрачность будет не #33(0.2), а 0.1(0.2*0.5).
            fillOpacity: 0.8,
            // Цвет обводки.
            strokeColor: '#0000FF',
            fillMethod: 'stretch',
            fillImageHref: 'https://pp.userapi.com/c834303/v834303410/dcf4a/tbFSd35-pOY.jpg',
            // Прозрачность обводки.
            strokeOpacity: 0.5,
            // Ширина линии.
            strokeWidth: 2,
            // Радиус скругления углов.
            // Данная опция принимается только прямоугольником.
            borderRadius: 6
        });

        myRectangle2 = new ymaps.Rectangle([
            [55.66, 37.60],
            [55.68, 37.62]
        ], null, {
            fillColor: '#7df9ff33',
            fillOpacity: 0.8,
            strokeColor: '#0000FF',
            fillMethod: 'stretch',
            fillImageHref: 'https://pp.userapi.com/c834303/v834303410/dceda/YR3ZG7fxPx0.jpg',
            strokeOpacity: 0.5,
            strokeWidth: 2,
            borderRadius: 6
        });

        myRectangle2.events.add('click', function (e) {
            // Если меню метки уже отображено, то убираем его.
            if ($('#menu').css('display') === 'block') {
                $('#menu').remove();
            } else {
                // HTML-содержимое контекстного меню.
                var menuContent =
                    '<div id="menu">\
                <div align="center"><input id="buysmth" type="submit" value="Buy"/></div>\
                <div align="center"><input id="passsmth" type="submit" value="Pass"/></div>\
                </div>';

                // Размещаем контекстное меню на странице
                $('body').append(menuContent);

                // alert(e.get('pagePixels'))
                // Задаем позицию меню.
                $('#menu').css({
                    left: e.get('pagePixels')[0],
                    top: e.get('pagePixels')[1]
                });


                $('#menu').find('input[id="buysmth"]').click(function () {
                    alert("Buy");
                    // Удаляем контекстное меню.
                    $('#menu').remove();
                });
                $('#menu').find('input[id="passsmth"]').click(function () {
                    alert("Pass");
                    // Удаляем контекстное меню.
                    $('#menu').remove();
                });
            }
        });

        myRectangle3 = new ymaps.Rectangle([
            [55.65, 37.55],
            [55.67, 37.53]
        ], null, {
            fillColor: '#7df9ff33',
            fillOpacity: 0.8,
            strokeColor: '#0000FF',
            fillMethod: 'stretch',
            fillImageHref: 'https://pp.userapi.com/c834303/v834303410/dcf51/sVjq5fcU0rU.jpg',
            strokeOpacity: 0.5,
            strokeWidth: 2,
            borderRadius: 6
        });

        myRectangle4 = new ymaps.Rectangle([
            [55.60, 37.59],
            [55.62, 37.57]
        ], null, {
            fillColor: '#7df9ff33',
            fillOpacity: 0.8,
            strokeColor: '#0000FF',
            fillMethod: 'stretch',
            fillImageHref: 'https://pp.userapi.com/c834303/v834303410/dcf8e/PPk7T3idjlY.jpg',
            strokeOpacity: 0.5,
            strokeWidth: 2,
            borderRadius: 6
        });

        myRectangle5 = new ymaps.Rectangle([
            [55.62, 37.66],
            [55.60, 37.69]
        ], null, {
            fillColor: '#7df9ff33',
            fillOpacity: 0.8,
            strokeColor: '#0000FF',
            fillMethod: 'stretch',
            fillImageHref: 'https://pp.userapi.com/c834303/v834303410/dcfdd/tQAOSeI41oc.jpg',
            strokeOpacity: 0.5,
            strokeWidth: 2,
            borderRadius: 6
        });

        var myPolyline = new ymaps.Polyline([
            [55.62, 37.58],
            [55.65, 37.54]
        ], null, {
            strokeColor: "#000000",
            strokeWidth: 4,
            strokeOpacity: 0.5
        });

        var myPolyline2 = new ymaps.Polyline([
            [55.70, 37.54],
            [55.67, 37.54]
        ], null, {
            strokeColor: "#000000",
            strokeWidth: 4,
            strokeOpacity: 0.5
        });

        var myPolyline3 = new ymaps.Polyline([
            [55.61, 37.66],
            [55.61, 37.59]
        ], null, {
            strokeColor: "#000000",
            strokeWidth: 4,
            strokeOpacity: 0.5
        });


        var myPolyline4 = new ymaps.Polyline([
            [55.62, 37.67],
            [55.66, 37.61]
        ], null, {
            strokeColor: "#000000",
            strokeWidth: 4,
            strokeOpacity: 0.5
        });


        var myPolyline5 = new ymaps.Polyline([
            [55.68, 37.61],
            [55.71, 37.55]
        ], null, {
            strokeColor: "#000000",
            strokeWidth: 4,
            strokeOpacity: 0.5
        });


        myMap.geoObjects
            .add(myRectangle)
            .add(myRectangle2)
            .add(myRectangle3)
            .add(myRectangle4)
            .add(myRectangle5)
            .add(myPolyline)
            .add(myPolyline2)
            .add(myPolyline3)
            .add(myPolyline4)
            .add(myPolyline5);
    }


</script>


</html>